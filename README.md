# 🌍 土地銀行綠易通 (Green 'E' Pass) - 企業ESG輔導平台

## ⚡ 快速開始（30秒）

```bash
# 1. 啟動伺服器
npm start

# 2. 打開瀏覽器
# 訪問：http://localhost:3000/assessment

# 3. 填寫表單並提交
```

---

## ⚠️ 常見問題快速解答

| 問題 | 解決方法 |
|:---:|:---|
| **「填好了還是不能評分」** | 按 F12 → Console 查看是否有紅色警告。確保所有下拉選單都已選擇。 |
| **「點擊評分按鈕沒反應」** | 檢查瀏覽器 Console（F12）中是否有「⚠️ 未填寫的欄位」提示 |
| **「結果顯示為 0 分」** | 這是 2025年10月31日已修復的問題。如仍出現，請刷新頁面（Ctrl+R）重試 |
| **「頁面顯示亂碼」** | 刷新頁面（Ctrl+R）或清除瀏覽器快取（Ctrl+Shift+Del） |
| **「伺服器無法啟動」** | 可能端口 3000 被佔用。執行：`netstat -ano | findstr :3000` 查看，然後 `taskkill /PID xxx /F` 終止 |

---

## 🔧 最近更新（2025-10-31）

### ✅ 已修復的問題

1. **表單字段名稱同步**
   - 修復：HTML 中的欄位名稱與 JavaScript 提取邏輯不匹配
   - 影響：導致評分時無法讀取表單數據

2. **複選框處理**
   - 修復：E3（廢棄物與水資源）使用 `formData.getAll()` 正確讀取多個複選框
   - 影響：原先該欄位無法正確計分

3. **表單驗證加強**
   - 新增：提交前檢查所有必填欄位是否已選擇
   - 效果：提交時若有空欄位會立即提示用戶

4. **控制台日誌**
   - 新增：詳細的調試日誌輸出
   - 好處：用戶可通過 F12 Console 快速診斷問題

5. **版權年份更新**
   - 修改：2024 → 2025

---

## 系統簡介

本系統為土地銀行推動永續金融的核心工具，提供中小企業（SMEs）一套簡單易用的ESG評分與輔導機制，幫助企業快速了解自身永續績效，並享受相應的金融優惠。

---

## 🎯 核心功能

### 1. TESES評分系統（中小企業簡易ESG評分機制）
- **100分制**：E(35分) + S(30分) + G(25分) + T(10分)
- **四級評分**：A級(≥80分) / B級(60-79分) / C級(30-59分) / D級(<30分)
- **利率優惠**：根據評分等級，自動計算利率減碼幅度
- **改善建議**：基於未得分指標提供具體改善方向

### 2. ESG輔導平台
- 📊 數位碳盤查工具（計算Scope 1 & Scope 2排放）
- 📝 模組化範本庫（E/S/G/T各面向）
- 💰 銀行產品專區（永續授信產品說明）

### 3. 兩階段評分機制
- **第一階段**：基礎門檻篩選（檢查是否有重大違規）
- **第二階段**：簡易永續績效評分（TESES12項指標）

---

## 📋 技術架構

### 後端
- **Node.js** + **Express.js** 
- REST API設計
- TESES計算引擎集成

### 前端
- HTML5 + CSS3（響應式設計）
- 原生JavaScript（無框架依賴）
- 動態表單與即時計算

### 數據庫
- 暫無持久化存儲（本版本）

---

## 🚀 快速開始

### 環境要求
- Node.js v14+
- npm v6+

### 安裝與啟動

```bash
# 1. 安裝依賴
npm install

# 2. 啟動伺服器
npm start

# 3. 打開瀏覽器
# 訪問 http://localhost:3000
```

### 訪問入口
| 頁面 | URL |
|:---:|:---|
| 首頁 | http://localhost:3000 |
| ESG評分系統 | http://localhost:3000/assessment |
| 輔導平台 | http://localhost:3000/platform |

---

## 📊 TESES評分指標詳解

### E（環境）- 35分

| 指標 | 滿分 | 評分標準 |
|:---:|:---:|:---|
| E1：碳管理意識與盤查 | 15分 | 已完成Scope 1&2盤查 |
| E2：能源效率改善 | 10分 | 已更新節能設備 |
| E3：廢棄物與水資源 | 10分 | 建立管理制度 |

### S（社會）- 30分

| 指標 | 滿分 | 評分標準 |
|:---:|:---:|:---|
| S1：員工培訓發展 | 10分 | 人均年培訓15小時+ |
| S2：員工福利 | 10分 | 優於法規福利 |
| S3：供應鏈管理 | 5分 | 簽署永續承諾 |
| S4：社區參與 | 5分 | 年度社區回饋 |

### G（治理）- 25分

| 指標 | 滿分 | 評分標準 |
|:---:|:---:|:---|
| G1：永續專責組織 | 10分 | 高階主管負責 |
| G2：法規遵循 | 10分 | 無重大違規 |
| G3：誠信經營 | 5分 | 納入公司規章 |

### T（轉型透明度）- 10分

| 指標 | 滿分 | 評分標準 |
|:---:|:---:|:---|
| T1：平台使用 | 5分 | 連續2年填報 |
| T2：永續目標 | 5分 | 公開量化目標 |

---

## 💰 評分等級與利率優惠

| 等級 | 分數 | 利率減碼 | 推薦產品 |
|:---:|:---:|:---:|:---|
| **A（領先級）** | ≥80 | 0.15% | 永續績效連結貸款、綠色融資 |
| **B（平均級）** | 60-79 | 0.075% | 一般永續授信、永續主題貸款 |
| **C（潛力級）** | 30-59 | 0% | 一般授信（需改善） |
| **D（風險級）** | <30 | -0.05% | 一般授信（加嚴審核） |

---

## 🔍 API 文檔

### POST /api/calculate-score
**計算ESG評分**

**請求：**
```json
{
    "e1_carbonManagement": "completed-scope1-2",
    "e2_energyEfficiency": "updated-equipment-past2y",
    "e3_waste": "yes",
    "e3_water": "yes",
    "s1_training": "yes-15hours",
    "s2_welfare": "exceeds-law",
    "s3_supplychain": "yes",
    "s4_community": "yes",
    "g1_sustainability": "executive-with-team",
    "g2_compliance": "no-major-violations",
    "g3_integrity": "yes",
    "t1_platform": "yes-2years",
    "t2_targets": "yes-quantitative"
}
```

**回應：**
```json
{
    "total": 100,
    "level": "A",
    "levelName": "領先級 (A)",
    "E": 35,
    "S": 30,
    "G": 25,
    "T": 10,
    "rateDiscount": 0.15,
    "products": ["永續績效連結貸款(SLL)", "綠色融資"],
    "improvements": [],
    "details": {
        "e1": 15,
        "e2": 10,
        "e3": 10,
        "s1": 10,
        "s2": 10,
        "s3": 5,
        "s4": 5,
        "g1": 10,
        "g2": 10,
        "g3": 5,
        "t1": 5,
        "t2": 5
    }
}
```

### POST /api/carbon-calculator
**計算碳足跡**

**請求：**
```json
{
    "electricity": 1000,
    "naturalGas": 50,
    "gasoline": 100,
    "diesel": 50,
    "lpg": 20
}
```

---

## 🐛 故障排除

### 問題 1：提交後沒有評分結果

**原因：**可能某些欄位沒有選擇任何值

**解決步驟：**
1. 打開瀏覽器開發者工具（F12）
2. 進入「Console」標籤
3. 查看是否有紅色錯誤信息
4. 檢查是否看到「⚠️ 未填寫的欄位」警告
5. 確保所有選擇欄位都已選定

### 問題 2：評分結果顯示為 0

**原因：**表單數據未正確提交到後端

**解決步驟：**
1. F12 → Console
2. 查看「📤 發送評分數據到後端」的日誌
3. 檢查數據是否完整
4. 查看「📥 收到後端回應」確認返回值

### 問題 3：API 返回 HTTP 錯誤

**原因：**伺服器故障或路由問題

**解決步驟：**
1. 確認伺服器仍在運行
2. 運行：`netstat -ano | findstr :3000`
3. 檢查是否有進程監聽端口 3000
4. 如沒有，重新啟動：`npm start`

### 問題 4：頁面無法載入

**原因：**伺服器未啟動或端口被占用

**解決步驟：**
```bash
# 1. 檢查端口占用
netstat -ano | findstr :3000

# 2. 如果有佔用，終止進程
taskkill /PID <PID> /F

# 3. 重新啟動伺服器
npm start
```

---

## 📱 瀏覽器相容性

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

---

## 📂 項目結構

```
Couple competition/
├── server.js                  # Express 後端伺服器
├── package.json              # 依賴管理
├── README.md                 # 本文件
│
├── views/                    # HTML 範本
│   ├── index.html           # 首頁
│   ├── assessment.html       # 評分系統
│   └── platform.html         # 輔導平台
│
├── public/                   # 靜態資源
│   ├── css/
│   │   └── style.css        # 全站樣式
│   ├── js/
│   │   ├── main.js          # 通用工具函數
│   │   ├── assessment.js    # 評分系統邏輯
│   │   └── platform.js      # 輔導平台邏輯
│   └── images/              # 圖片資源
│
└── docs/                     # 文檔
    ├── 永續金融提案報告.md
    ├── TESES_說明.md
    └── 實施摘要.md
```

---

## 🔐 安全性注意事項

- ⚠️ 本版本未包含認證機制
- ⚠️ 請勿在生產環境直接使用
- 💡 建議添加：用戶認證、數據加密、速率限制

---

## 📞 支持與反饋

如有任何問題或建議，請聯絡土地銀行永續金融團隊。

---

## 📄 授權

© 2025 土地銀行 | 綠易通 (Green 'E' Pass)

---

## 版本歷史

| 版本 | 日期 | 更新內容 |
|:---:|:---:|:---|
| v1.1 | 2025-10-31 | **戰略性精修版本**：權重調整（E:30, S:30, G:25, T:15）；新增T3轉型承諾指標；強化風險管理（重大違規紅線）；增加特殊優惠/懲罰機制 |
| v1.0 | 2025-10-31 | 初始發布，包含TESES評分系統 |

