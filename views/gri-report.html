<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GRI è©•ä¼°å ±å‘Š - åœŸåœ°éŠ€è¡Œæ°¸çºŒæ©‹æ¨‘è¨ˆç•«</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        /* å ±å‘Šé é¢å°ˆç”¨æ¨£å¼ */
        .report-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            padding: 2.5rem;
            margin-bottom: 2rem;
        }

        .report-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 12px;
            margin-bottom: 2.5rem;
            text-align: center;
            box-shadow: 0 8px 24px rgba(0, 102, 51, 0.15);
        }

        .report-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .report-header p {
            font-size: 1.05rem;
            opacity: 0.95;
        }

        .report-timestamp {
            font-size: 0.9rem;
            opacity: 0.85;
            margin-top: 1rem;
        }

        .score-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .score-card {
            background: linear-gradient(135deg, var(--bg-light) 0%, white 100%);
            padding: 2rem;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            text-align: center;
            transition: all 0.3s ease;
        }

        .score-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 16px rgba(0, 102, 51, 0.1);
        }

        .score-card-label {
            font-size: 0.95rem;
            color: var(--text-light);
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .score-card-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .score-card-max {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .score-progress {
            margin-top: 1rem;
        }

        .score-progress-bar {
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .score-progress-fill {
            height: 100%;
            background: var(--primary-color);
            border-radius: 3px;
            transition: width 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .report-level {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            color: white;
            padding: 2.5rem;
            border-radius: 10px;
            margin-bottom: 2.5rem;
            text-align: center;
        }

        .report-level-title {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .report-level-name {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .report-level-description {
            font-size: 1rem;
            line-height: 1.6;
            opacity: 0.95;
        }

        .report-section {
            margin-bottom: 2.5rem;
        }

        .report-section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border-color);
        }

        .questions-detail {
            background: var(--bg-light);
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .question-item {
            background: white;
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            border-left: 3px solid var(--accent-color);
        }

        .question-item:last-child {
            margin-bottom: 0;
        }

        .question-label {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .question-answer {
            color: var(--primary-color);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .recommendation-box {
            background: linear-gradient(135deg, rgba(0, 102, 51, 0.05) 0%, rgba(0, 179, 179, 0.05) 100%);
            border: 1px solid rgba(0, 102, 51, 0.1);
            border-left: 4px solid var(--primary-color);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .recommendation-box h4 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .recommendation-box p {
            line-height: 1.7;
            color: var(--text-dark);
        }

        .action-buttons {
            text-align: center;
            margin-top: 2.5rem;
            padding-top: 2rem;
            border-top: 2px solid var(--border-color);
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 1rem 2rem;
            border-radius: 8px;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 12px rgba(0, 102, 51, 0.2);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 102, 51, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--bg-light);
            transform: translateY(-2px);
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            margin: 2rem 0;
        }

        @media (max-width: 768px) {
            .report-container {
                padding: 1.5rem;
            }

            .report-header {
                padding: 2rem 1.5rem;
            }

            .report-header h1 {
                font-size: 1.8rem;
            }

            .score-summary {
                gap: 1rem;
            }

            .score-card {
                padding: 1.5rem;
            }

            .score-card-value {
                font-size: 2rem;
            }

            .action-buttons {
                flex-direction: column;
            }

            .action-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <span>ğŸ¦</span>
                <span>åœŸåœ°éŠ€è¡Œæ°¸çºŒæ©‹æ¨‘è¨ˆç•«</span>
            </div>
            <ul class="nav-links">
                <li><a href="/">é¦–é </a></li>
                <li><a href="/assessment">ESGè©•åˆ†ç³»çµ±</a></li>
                <li><a href="/gri-assessment">GRIè©•ä¼°</a></li>
                <li><a href="/platform">è¼”å°å¹³å°</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <!-- å ±å‘Šæ¨™é¡Œ -->
        <section class="report-header">
            <h1>ğŸ“Š GRI è©•ä¼°å ±å‘Š</h1>
            <p>æ‚¨çš„ä¼æ¥­æ°¸çºŒç™¼å±•æˆç†Ÿåº¦è©•ä¼°çµæœ</p>
            <div class="report-timestamp" id="report-timestamp"></div>
        </section>

        <!-- å ±å‘Šå…§å®¹ -->
        <section class="report-container" id="report-content">
            <!-- è©•åˆ†å¡ç‰‡ -->
            <div class="score-summary">
                <div class="score-card">
                    <div class="score-card-label">ğŸŒ ç’°å¢ƒ (E)</div>
                    <div class="score-card-value" id="score-e">-</div>
                    <div class="score-card-max">æœ€é«˜ 24 åˆ†</div>
                    <div class="score-progress">
                        <div class="score-progress-bar">
                            <div class="score-progress-fill" id="progress-e" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <div class="score-card">
                    <div class="score-card-label">ğŸ‘¥ ç¤¾æœƒ (S)</div>
                    <div class="score-card-value" id="score-s">-</div>
                    <div class="score-card-max">æœ€é«˜ 30 åˆ†</div>
                    <div class="score-progress">
                        <div class="score-progress-bar">
                            <div class="score-progress-fill" id="progress-s" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <div class="score-card">
                    <div class="score-card-label">âš–ï¸ æ²»ç† (G)</div>
                    <div class="score-card-value" id="score-g">-</div>
                    <div class="score-card-max">æœ€é«˜ 24 åˆ†</div>
                    <div class="score-progress">
                        <div class="score-progress-bar">
                            <div class="score-progress-fill" id="progress-g" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è©•ç´š -->
            <section class="report-level">
                <div class="report-level-title">æ•´é«”è©•ç´š</div>
                <div class="report-level-name" id="report-level-name">-</div>
                <div class="report-level-description" id="report-level-description">
                    è©•ä¼°ä¸­...
                </div>
            </section>

            <!-- è©³ç´°ç­”æ¡ˆ -->
            <section class="report-section">
                <h2 class="report-section-title">ğŸ“ è©³ç´°ç­”æ¡ˆ</h2>
                <div class="questions-detail" id="questions-detail">
                    åŠ è¼‰ä¸­...
                </div>
            </section>

            <!-- å»ºè­° -->
            <section class="report-section">
                <h2 class="report-section-title">ğŸ’¡ æ”¹å–„å»ºè­°</h2>
                <div id="recommendations">
                    åŠ è¼‰ä¸­...
                </div>
            </section>

            <!-- è¡Œå‹•æŒ‰éˆ• -->
            <div class="action-buttons">
                <a href="/gri-assessment" class="action-btn btn-secondary">
                    â† é‡æ–°è©•ä¼°
                </a>
                <button class="action-btn btn-primary" onclick="window.print()">
                    ğŸ–¨ï¸ åˆ—å°å ±å‘Š
                </button>
                <a href="/" class="action-btn btn-secondary">
                    è¿”å›é¦–é 
                </a>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 åœŸåœ°éŠ€è¡Œ | æ°¸çºŒæ©‹æ¨‘è¨ˆç•«</p>
    </footer>

    <script>
        // GRI è©•åˆ†è¨ˆç®—é‚è¼¯
        function calculateGRIScore(responses) {
            const scoreMapping = {
                'no': 1,
                'basic': 2,
                'yes': 3,
                'developing': 2,
                'advanced': 3
            };

            let scores = {
                E: 0,
                S: 0,
                G: 0,
                total: 0,
                level: '',
                levelName: '',
                summary: ''
            };

            // è¨ˆç®—å„æ§‹é¢å¾—åˆ†
            ['E', 'S', 'G'].forEach(category => {
                if (responses[category]) {
                    responses[category].forEach(item => {
                        const score = scoreMapping[item.value] || 0;
                        scores[category] += score;
                    });
                }
            });

            // è¨ˆç®—ç¸½åˆ†ï¼ˆåŠ æ¬Šå¹³å‡ï¼‰
            // Eå’ŒSå„ä½”35%ï¼ŒGä½”30%
            // å…ˆè¨ˆç®—å„æ§‹é¢çš„å¹³å‡åˆ†ï¼ˆæ»¿åˆ†3åˆ†ï¼‰
            const eAvg = scores.E / 8;   // 8é¡Œ
            const sAvg = scores.S / 10;  // 10é¡Œ
            const gAvg = scores.G / 8;   // 8é¡Œ
            const totalWeighted = (eAvg * 0.35 + sAvg * 0.35 + gAvg * 0.30);
            scores.total = Math.round(totalWeighted * 100) / 100;

            // åˆ¤æ–·ç­‰ç´š - æŒ‰ç™¾åˆ†æ¯”ï¼ˆæ»¿åˆ†100%ï¼‰
            const percentage = (scores.total / 3) * 100;
            if (percentage >= 85) {
                scores.level = 'A';
                scores.levelName = 'é ˜å…ˆç´š (A)';
                scores.summary = 'æ‚¨çš„å…¬å¸å·²å…·å‚™å“è¶Šçš„æ°¸çºŒç™¼å±•å¯¦è¸ï¼ˆ85-100%ï¼‰ï¼Œå»ºè­°é€²ä¸€æ­¥å°‹æ±‚ç¬¬ä¸‰æ–¹é©—è­‰æˆ–èªè­‰ã€‚';
            } else if (percentage >= 70) {
                scores.level = 'B';
                scores.levelName = 'å¹³å‡ç´š (B)';
                scores.summary = 'æ‚¨çš„å…¬å¸å…·å‚™è‰¯å¥½çš„æ°¸çºŒç™¼å±•åŸºç¤ï¼ˆ70-84%ï¼‰ï¼Œå»ºè­°é‡é»è£œå¼·è©•åˆ†è¼ƒä½çš„æ§‹é¢ã€‚';
            } else if (percentage >= 55) {
                scores.level = 'C';
                scores.levelName = 'é€²å±•ç´š (C)';
                scores.summary = 'æ‚¨çš„å…¬å¸å·²é–‹å§‹å»ºç«‹æ°¸çºŒç®¡ç†é«”ç³»ï¼ˆ55-69%ï¼‰ï¼Œå»ºè­°å„ªå…ˆæ”¹å–„ç’°å¢ƒèˆ‡æ²»ç†æ§‹é¢ã€‚';
            } else {
                scores.level = 'D';
                scores.levelName = 'åˆæœŸç´š (D)';
                scores.summary = 'å»ºè­°å¾åŸºç¤æ”¿ç­–åˆ¶å®šèˆ‡å“¡å·¥æ„è­˜æå‡é–‹å§‹è‘—æ‰‹ï¼ˆ<55%ï¼‰ï¼Œé€æ­¥å»ºç«‹æ°¸çºŒç™¼å±•æ–‡åŒ–ã€‚';
            }

            return scores;
        }

        // é é¢è¼‰å…¥
        document.addEventListener('DOMContentLoaded', function() {
            const data = localStorage.getItem('griAssessmentData');
            
            if (!data) {
                document.getElementById('report-content').innerHTML = '<div class="error-message">âŒ ç„¡æ³•è¼‰å…¥è©•ä¼°æ•¸æ“šï¼Œè«‹é‡æ–°é€²è¡Œè©•ä¼°ã€‚</div>';
                return;
            }

            const assessmentData = JSON.parse(data);
            const responses = assessmentData.responses;
            const timestamp = new Date(assessmentData.timestamp);

            // è¨ˆç®—å¾—åˆ†
            const scores = calculateGRIScore(responses);

            // é¡¯ç¤ºæ™‚é–“æˆ³
            document.getElementById('report-timestamp').textContent = 
                'è©•ä¼°æ™‚é–“ï¼š' + timestamp.toLocaleDateString('zh-TW') + ' ' + timestamp.toLocaleTimeString('zh-TW');

            // é¡¯ç¤ºè©•åˆ†
            document.getElementById('score-e').textContent = scores.E.toFixed(1);
            document.getElementById('score-s').textContent = scores.S.toFixed(1);
            document.getElementById('score-g').textContent = scores.G.toFixed(1);

            // é¡¯ç¤ºé€²åº¦æ¢
            document.getElementById('progress-e').style.width = (scores.E / 24 * 100) + '%';
            document.getElementById('progress-s').style.width = (scores.S / 30 * 100) + '%';
            document.getElementById('progress-g').style.width = (scores.G / 24 * 100) + '%';

            // é¡¯ç¤ºè©•ç´š
            document.getElementById('report-level-name').textContent = scores.levelName;
            document.getElementById('report-level-description').textContent = scores.summary;

            // é¡¯ç¤ºè©³ç´°ç­”æ¡ˆ
            let detailsHTML = '';
            ['E', 'S', 'G'].forEach(category => {
                detailsHTML += '<div style="margin-bottom: 1.5rem;"><h4 style="color: var(--primary-color); margin-bottom: 1rem;">';
                if (category === 'E') detailsHTML += 'ğŸŒ ç’°å¢ƒ (E)';
                if (category === 'S') detailsHTML += 'ğŸ‘¥ ç¤¾æœƒ (S)';
                if (category === 'G') detailsHTML += 'âš–ï¸ æ²»ç† (G)';
                detailsHTML += '</h4>';

                if (responses[category]) {
                    responses[category].forEach((item, index) => {
                        // ç§»é™¤é¡Œç›®ä¸­é–‹é ­çš„ "E1. " "E2. " ç­‰å‰ç¶´
                        let questionText = (item.question || 'æœªçŸ¥é¡Œç›®').replace(/^[ESG]\d+\.\s+/, '');
                        detailsHTML += '<div class="question-item">';
                        detailsHTML += '<div class="question-label">' + category + (index + 1) + 'ï¼š' + questionText + '</div>';
                        detailsHTML += '<div class="question-answer">âœ“ ' + item.label + '</div>';
                        detailsHTML += '</div>';
                    });
                }
                detailsHTML += '</div>';
            });
            document.getElementById('questions-detail').innerHTML = detailsHTML;

            // é¡¯ç¤ºå»ºè­°
            let recommendationsHTML = '';
            if (scores.level === 'A') {
                recommendationsHTML = `
                    <div class="recommendation-box">
                        <h4>ğŸ† æ‚¨å·²é”åˆ°é ˜å…ˆç´šæ°´æº–ï¼</h4>
                        <p>
                            æ­å–œï¼æ‚¨çš„ä¼æ¥­å·²åœ¨ ESG å„å€‹é¢å‘å±•ç¾å‡ºè‰²çš„è¡¨ç¾ã€‚å»ºè­°æ‚¨ï¼š
                            <ul style="margin-top: 1rem; margin-left: 1.5rem;">
                                <li>è€ƒæ…®ç”³è«‹ç¬¬ä¸‰æ–¹ ESG èªè­‰æˆ–é©—è­‰</li>
                                <li>æˆç‚ºæ¥­ç•Œæ°¸çºŒç™¼å±•æ¨™ç«¿ä¼æ¥­</li>
                                <li>æ·±åŒ–å“¡å·¥å’Œä¾›æ‡‰éˆçš„æ°¸çºŒæ„è­˜åŸ¹è¨“</li>
                                <li>é€²ä¸€æ­¥æ“´å¤§æ‚¨çš„æ°¸çºŒç™¼å±•å ±å‘Šç¯„åœ</li>
                            </ul>
                        </p>
                    </div>
                `;
            } else if (scores.level === 'B') {
                recommendationsHTML = `
                    <div class="recommendation-box">
                        <h4>ğŸ“ˆ ç©©æ­¥å‰é€²çš„å¹³å‡ç´šä¼æ¥­</h4>
                        <p>
                            æ‚¨çš„ä¼æ¥­å·²å»ºç«‹è‰¯å¥½çš„æ°¸çºŒåŸºç¤ã€‚å»ºè­°æ‚¨ï¼š
                            <ul style="margin-top: 1rem; margin-left: 1.5rem;">
                                <li>é‡å°å¾—åˆ†è¼ƒä½çš„æ§‹é¢é€²è¡Œæ·±å…¥æ”¹å–„</li>
                                <li>å»ºç«‹é‡åŒ–çš„æ°¸çºŒç™¼å±•ç›®æ¨™</li>
                                <li>å®šæœŸé€²è¡Œ ESG ç¸¾æ•ˆè©•ä¼°å’Œæ›´æ–°</li>
                                <li>èˆ‡ä¾›æ‡‰å•†åˆ†äº«æ°¸çºŒç™¼å±•ç†å¿µ</li>
                            </ul>
                        </p>
                    </div>
                `;
            } else if (scores.level === 'C') {
                recommendationsHTML = `
                    <div class="recommendation-box">
                        <h4>ğŸŒ± æˆé•·ä¸­çš„ä¼æ¥­ - åŠ æ²¹ï¼</h4>
                        <p>
                            æ‚¨çš„ä¼æ¥­å·²é–‹å§‹é‡è¦–æ°¸çºŒç™¼å±•ã€‚å»ºè­°æ‚¨ï¼š
                            <ul style="margin-top: 1rem; margin-left: 1.5rem;">
                                <li>å„ªå…ˆå®Œå–„ç’°å¢ƒå’Œæ²»ç†æ”¿ç­–</li>
                                <li>æŒ‡æ´¾å°ˆè²¬äººå“¡æ¨å‹• ESG å·¥ä½œ</li>
                                <li>åˆ¶å®šæ˜ç¢ºçš„æ”¹å–„æ™‚ç¨‹è¡¨</li>
                                <li>å°‹æ±‚å¤–éƒ¨å”åŠ©å’Œè³‡æºæ”¯æŒ</li>
                            </ul>
                        </p>
                    </div>
                `;
            } else {
                recommendationsHTML = `
                    <div class="recommendation-box">
                        <h4>ğŸš€ èµ·æ­¥éšæ®µ - é–‹å•Ÿæ°¸çºŒä¹‹æ—…</h4>
                        <p>
                            æ‚¨çš„ä¼æ¥­æ­£åœ¨æ°¸çºŒç™¼å±•çš„èµ·æ­¥éšæ®µã€‚å»ºè­°æ‚¨ï¼š
                            <ul style="margin-top: 1rem; margin-left: 1.5rem;">
                                <li>å¾åˆ¶å®šåŸºæœ¬æ°¸çºŒæ”¿ç­–é–‹å§‹</li>
                                <li>å»ºç«‹å…¬å¸å±¤ç´šçš„ ESG æ²»ç†çµæ§‹</li>
                                <li>é€²è¡Œå“¡å·¥æ°¸çºŒæ„è­˜åŸ¹è¨“</li>
                                <li>åˆ©ç”¨æœ¬å¹³å°çš„è¼”å°å·¥å…·é€²è¡Œæ”¹å–„</li>
                            </ul>
                        </p>
                    </div>
                `;
            }
            document.getElementById('recommendations').innerHTML = recommendationsHTML;

            // æ¸…é™¤ localStorage
            // localStorage.removeItem('griAssessmentData');
        });
    </script>
</body>
</html>
